# Dollar Insight í”„ë¡œì íŠ¸ í¬íŒ… ë§¤ë‰´ì–¼

> ğŸ’¡ **ë¹ ë¥¸ ë°°í¬**: í”„ë¡œì íŠ¸ëŠ” `deploy.sh` ìë™í™” ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ê°„í¸í•˜ê²Œ ë°°í¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> ```bash
> ./deploy.sh deploy              # ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬
> ./deploy.sh build-and-deploy-apk # Flutter APK ë¹Œë“œ ë° ë°°í¬
> ```

## ëª©ì°¨
1. [Gitlab ì†ŒìŠ¤ í´ë¡  ì´í›„ ë¹Œë“œ ë° ë°°í¬ ë¬¸ì„œ](#1-gitlab-ì†ŒìŠ¤-í´ë¡ -ì´í›„-ë¹Œë“œ-ë°-ë°°í¬-ë¬¸ì„œ)
   - [1.1 ì‚¬ìš© í™˜ê²½ ë° ê¸°ìˆ  ìŠ¤íƒ](#11-ì‚¬ìš©-í™˜ê²½-ë°-ê¸°ìˆ -ìŠ¤íƒ)
   - [1.2 ë¹Œë“œ ì‹œ ì‚¬ìš©ë˜ëŠ” í™˜ê²½ ë³€ìˆ˜](#12-ë¹Œë“œ-ì‹œ-ì‚¬ìš©ë˜ëŠ”-í™˜ê²½-ë³€ìˆ˜)
   - [1.3 ë°°í¬ ì‹œ íŠ¹ì´ì‚¬í•­](#13-ë°°í¬-ì‹œ-íŠ¹ì´ì‚¬í•­)
   - [1.4 DB ì ‘ì† ì •ë³´ ë° ì£¼ìš” ì„¤ì • íŒŒì¼](#14-db-ì ‘ì†-ì •ë³´-ë°-ì£¼ìš”-ì„¤ì •-íŒŒì¼)
2. [í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì™¸ë¶€ ì„œë¹„ìŠ¤ ì •ë³´](#2-í”„ë¡œì íŠ¸ì—ì„œ-ì‚¬ìš©í•˜ëŠ”-ì™¸ë¶€-ì„œë¹„ìŠ¤-ì •ë³´)
3. [ë¹Œë“œ ë° ë°°í¬ ëª…ë ¹ì–´](#ë¹Œë“œ-ë°-ë°°í¬-ëª…ë ¹ì–´)
   - [ê°œë°œ í™˜ê²½ ì‹¤í–‰](#ê°œë°œ-í™˜ê²½-ì‹¤í–‰)
   - [ìš´ì˜ í™˜ê²½ ë°°í¬ (deploy.sh)](#ìš´ì˜-í™˜ê²½-ë°°í¬)
   - [ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”](#ë°ì´í„°ë² ì´ìŠ¤-ì´ˆê¸°í™”)

---

## 1. Gitlab ì†ŒìŠ¤ í´ë¡  ì´í›„ ë¹Œë“œ ë° ë°°í¬ ë¬¸ì„œ

### 1.1 ì‚¬ìš© í™˜ê²½ ë° ê¸°ìˆ  ìŠ¤íƒ

#### ì£¼ìš” ê¸°ìˆ  ë° ë²„ì „

| êµ¬ë¶„ | ê¸°ìˆ /í”„ë ˆì„ì›Œí¬ | ë²„ì „ |
|------|-----------------|------|
| **Backend** | Java | JDK 17 |
| | Spring Boot | 3.5.x |
| | Spring Security | 6.x |
| | JWT | - |
| **Frontend** | Flutter | 3.x |
| | Dart | 3.x |
| **Mobile** | React Native | 0.81.4 |
| | React | 19.1.0 |
| | Expo | 54.0.2 |
| **Database** | PostgreSQL | 15.x |
| | MongoDB | 7.x |
| | Redis | 7.x |
| | ChromaDB | - |
| **Infrastructure** | Docker | Latest |
| | Docker Compose | V2 |
| | Nginx | 1.25.x |
| | AWS EC2 | Ubuntu 22.04 LTS |
| **Monitoring** | Prometheus | 2.53.0 |
| | Grafana | 11.2.0 |
| | Node Exporter | v1.8.1 |
| **CI/CD** | Jenkins | 2.x |
| | GitLab CI/CD | - |

#### IDE ë° ê°œë°œ ë„êµ¬
- IntelliJ IDEA 2024.x (Backend)
- VS Code (Frontend/Mobile)
- Android Studio (Mobile Development)
- Docker Desktop

### 1.2 ë¹Œë“œ ì‹œ ì‚¬ìš©ë˜ëŠ” í™˜ê²½ ë³€ìˆ˜

> âš ï¸ **ì¤‘ìš”**: ëª¨ë“  í™˜ê²½ ë³€ìˆ˜ëŠ” `.env.template` íŒŒì¼ì„ ë³µì‚¬í•˜ì—¬ `.env` íŒŒì¼ë¡œ ìƒì„±í•œ í›„ ì‚¬ìš©í•©ë‹ˆë‹¤.
> ìƒì„¸í•œ ì„¤ì • ë°©ë²•ì€ **[ENV_SETUP_GUIDE.md](../ENV_SETUP_GUIDE.md)**ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

#### í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ êµ¬ì¡°

í”„ë¡œì íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì€ í™˜ê²½ ë³€ìˆ˜ íŒŒì¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:

```
S13P31B205/
â”œâ”€â”€ .env.template           # ë£¨íŠ¸ í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â”œâ”€â”€ .env                    # ì‹¤ì œ í™˜ê²½ ë³€ìˆ˜ (Git ì œì™¸)
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ .env.template      # Backend í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â”‚   â””â”€â”€ .env               # ì‹¤ì œ í™˜ê²½ ë³€ìˆ˜ (Git ì œì™¸)
â”œâ”€â”€ ai-service/
â”‚   â”œâ”€â”€ .env.template      # AI Service í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
â”‚   â””â”€â”€ .env               # ì‹¤ì œ í™˜ê²½ ë³€ìˆ˜ (Git ì œì™¸)
â””â”€â”€ frontend/
    â”œâ”€â”€ .env.template      # Frontend í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿
    â””â”€â”€ .env               # ì‹¤ì œ í™˜ê²½ ë³€ìˆ˜ (Git ì œì™¸)
```

#### í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ë°©ë²•

**1. ë£¨íŠ¸ ë””ë ‰í† ë¦¬ (.env)**
```bash
# í…œí”Œë¦¿ ë³µì‚¬
cp .env.template .env

# ì£¼ìš” ì„¤ì • í•­ëª©
POSTGRES_USER=your-postgres-username
POSTGRES_PASSWORD=your-postgres-password
POSTGRES_DB=dollar_insight

MONGO_USER=your-mongo-username
MONGO_PASSWORD=your-mongo-password

REDIS_PASSWORD=your-redis-password

# Admin Tools
PGADMIN_EMAIL=your-email@example.com
PGADMIN_PASSWORD=your-pgadmin-password
```

**2. Backend (.env)**
```bash
# í…œí”Œë¦¿ ë³µì‚¬
cp backend/.env.template backend/.env

# ì£¼ìš” ì„¤ì • í•­ëª©
SPRING_DATASOURCE_USERNAME=your-postgres-username
SPRING_DATASOURCE_PASSWORD=your-postgres-password

SPRING_DATA_MONGODB_USERNAME=your-mongo-username
SPRING_DATA_MONGODB_PASSWORD=your-mongo-password

SPRING_REDIS_PASSWORD=your-redis-password

# JWT Secret (ë³´ì•ˆ ì¤‘ìš”!)
# ìƒì„±: openssl rand -base64 32
APP_JWT_SECRET=your-jwt-secret-key-min-32-characters
APP_JWT-ACCESS_TTL_SECONDS=900
```

**3. AI Service (.env)**
```bash
# í…œí”Œë¦¿ ë³µì‚¬
cp ai-service/.env.template ai-service/.env

# ì£¼ìš” ì„¤ì • í•­ëª©
REDIS_PASSWORD=your-redis-password

MONGODB_USER=your-mongo-username
MONGODB_PASSWORD=your-mongo-password
```

**4. Frontend (.env)**
```bash
# í…œí”Œë¦¿ ë³µì‚¬
cp frontend/.env.template frontend/.env

# ì£¼ìš” ì„¤ì • í•­ëª©
BASE_URL=https://k13b205.p.ssafy.io

KAKAO_API_KEY=your-kakao-api-key
KAKAO_NATIVE_APP_KEY=your-kakao-native-app-key
KAKAO_REDIRECT_URI=your-kakao-redirect-uri
```

#### í™˜ê²½ ë³€ìˆ˜ ê²€ì¦

ëª¨ë“  í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•œ í›„, ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ ëˆ„ë½ëœ íŒŒì¼ì´ ì—†ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤:

```bash
# í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
chmod +x check-env.sh
./check-env.sh
```

#### ë³´ì•ˆ ì£¼ì˜ì‚¬í•­

- âœ… `.env.template` íŒŒì¼ë§Œ Gitì— ì»¤ë°‹ (í”Œë ˆì´ìŠ¤í™€ë” ê°’ë§Œ í¬í•¨)
- âœ… ì‹¤ì œ `.env` íŒŒì¼ì€ ë¡œì»¬ì—ë§Œ ë³´ê´€ (`.gitignore`ì— í¬í•¨ë¨)
- âœ… JWT Secretì€ ë°˜ë“œì‹œ ê°•ë ¥í•œ ëœë¤ ê°’ ì‚¬ìš© (`openssl rand -base64 32`)
- âœ… ëª¨ë“  ë¹„ë°€ë²ˆí˜¸ëŠ” 16ì ì´ìƒ, ëŒ€ì†Œë¬¸ì/ìˆ«ì/íŠ¹ìˆ˜ë¬¸ì í¬í•¨
- âŒ ì‹¤ì œ API í‚¤ë‚˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì½”ë“œì— í•˜ë“œì½”ë”© ê¸ˆì§€
- âŒ `.env` íŒŒì¼ì„ ì ˆëŒ€ Gitì— ì»¤ë°‹í•˜ì§€ ì•ŠìŒ

### 1.3 ë°°í¬ ì‹œ íŠ¹ì´ì‚¬í•­

#### ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜
- **Backend (Spring Boot)**: REST API, ì¸ì¦/ì¸ê°€, ë°ì´í„° ê´€ë¦¬
- **AI Service (FastAPI)**: AI ë¶„ì„, ìì—°ì–´ ì²˜ë¦¬
- **Frontend (Flutter)**: ëª¨ë°”ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜
- **Database**: PostgreSQL(ë©”ì¸), MongoDB(ì±„íŒ…/ë‰´ìŠ¤), Redis(ìºì‹œ), ChromaDB(ë²¡í„°)


#### Docker ì»¨í…Œì´ë„ˆ êµ¬ì„±
```
dollarinsight/
â”œâ”€â”€ backend/ (Spring Boot)
â”œâ”€â”€ ai-service/ (FastAPI)
â”œâ”€â”€ mobile/ (Flutter)
â”œâ”€â”€ postgres/
â”œâ”€â”€ mongodb/
â”œâ”€â”€ redis/
â”œâ”€â”€ chromadb/
â”œâ”€â”€ nginx/
â””â”€â”€ docker-compose.yml
```

#### ë°°í¬ ìˆœì„œ

**1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •** âš ï¸ ë§¤ìš° ì¤‘ìš”!
```bash
# ëª¨ë“  .env.template íŒŒì¼ì„ .envë¡œ ë³µì‚¬
cp .env.template .env
cp backend/.env.template backend/.env
cp ai-service/.env.template ai-service/.env
cp frontend/.env.template frontend/.env

# ê° .env íŒŒì¼ì˜ í”Œë ˆì´ìŠ¤í™€ë”(your-*)ë¥¼ ì‹¤ì œ ê°’ìœ¼ë¡œ êµì²´
# ìƒì„¸ ê°€ì´ë“œ: ENV_SETUP_GUIDE.md ì°¸ì¡°

# í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
chmod +x check-env.sh
./check-env.sh
```

**2. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”**
- PostgreSQL, MongoDB ìŠ¤í‚¤ë§ˆ ì„¤ì •
- ì´ˆê¸° ë°ì´í„° ë¡œë“œ

**3. Docker ë¹Œë“œ ë° ì‹¤í–‰**
```bash
# ê°œë°œ í™˜ê²½ (ë¡œì»¬)
docker-compose up -d --build

# ìš´ì˜ í™˜ê²½ (ì„œë²„) - deploy.sh ì‚¬ìš© ê¶Œì¥
./deploy.sh deploy              # ì¼ë°˜ ë°°í¬
./deploy.sh deploy-all          # ìµœì´ˆ ë°°í¬ (ëª¨ë“  ì„œë¹„ìŠ¤ ì‹œì‘)
```

**4. SSL ì¸ì¦ì„œ ì„¤ì •**
- Let's Encrypt ë˜ëŠ” ì‚¬ì„¤ ì¸ì¦ì„œ
- Nginx HTTPS ë¦¬ë‹¤ì´ë ‰ì…˜ í™œì„±í™”

**5. Nginx ì„¤ì •**
- ë¦¬ë²„ìŠ¤ í”„ë¡ì‹œ ì„¤ì • í™•ì¸
- Rate Limiting ì„¤ì •

**6. Jenkins Pipeline** (ì„ íƒì‚¬í•­)
- ìë™ ë¹Œë“œ/ë°°í¬ ì„¤ì •
- GitLab Webhook ì—°ë™

**7. Airflow (ë°ì´í„° íŒŒì´í”„ë¼ì¸)** - ì„ íƒì‚¬í•­
- **ìš©ë„**: ì£¼ì‹ ë°ì´í„° ìˆ˜ì§‘, ë‰´ìŠ¤ í¬ë¡¤ë§, AI ë°°ì¹˜ ë¶„ì„
- **ë°°í¬ í•„ìš”ì„±**:
  - âœ… ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸ í•„ìš” ì‹œ
  - âŒ ë°ëª¨/ë°œí‘œìš©ì€ ìƒëµ ê°€ëŠ¥
- **ì‹¤í–‰ ëª…ë ¹ì–´**:
  ```bash
  cd ai-service
  docker-compose -f docker-compose.airflow.yml up -d
  ```





#### ë„¤íŠ¸ì›Œí¬ ì„¤ì •
- **í¬íŠ¸ ë§¤í•‘**: 
  - Backend: 8080
  - AI Service: 8001  
  - PostgreSQL: 5432 (ë‚´ë¶€)
  - MongoDB: 27017 (ë‚´ë¶€)
  - Redis: 6379 (ë‚´ë¶€)
  - ChromaDB: 8000 (ë‚´ë¶€)
- **SSL/TLS**: HTTPS 443í¬íŠ¸
- **ë°©í™”ë²½**: SSH(22), HTTP(80), HTTPS(443)ë§Œ ì˜¤í”ˆ

### 1.4 DB ì ‘ì† ì •ë³´ ë° ì£¼ìš” ì„¤ì • íŒŒì¼

> ğŸ’¡ **ì¤‘ìš”**: ì´ ì„¹ì…˜ì€ **ì‹¬ì‚¬ìœ„ì›ì´ í”„ë¡œì íŠ¸ë¥¼ ì¬í˜„í•  ë•Œ** ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì •ë³´ì™€ ì„¤ì • íŒŒì¼ ìœ„ì¹˜ë¥¼ ë¹ ë¥´ê²Œ ì°¾ì„ ìˆ˜ ìˆë„ë¡ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.


**1. Spring Boot ì„¤ì • íŒŒì¼**

```
backend/src/main/resources/
â”œâ”€â”€ application.yml           # ë©”ì¸ ì„¤ì • (í™˜ê²½ ë³€ìˆ˜ ì°¸ì¡°)
â”œâ”€â”€ application-local.yml     # ë¡œì»¬ ê°œë°œ í™˜ê²½ ì„¤ì •
â””â”€â”€ application-prod.yml      # ìš´ì˜ í™˜ê²½ ì„¤ì •
```

**2. Docker ì„¤ì • íŒŒì¼**

```
í”„ë¡œì íŠ¸ ë£¨íŠ¸/
â”œâ”€â”€ docker-compose.yml        # ì»¨í…Œì´ë„ˆ ì„¤ì • (.env íŒŒì¼ ì°¸ì¡°)
â””â”€â”€ .env                      # Docker Compose í™˜ê²½ ë³€ìˆ˜
```

**3. Nginx ì„¤ì • íŒŒì¼**

```
nginx/
â”œâ”€â”€ nginx.conf               # Nginx ë©”ì¸ ì„¤ì •
â””â”€â”€ conf.d/
    â”œâ”€â”€ server.conf          # ì„œë²„ ì„¤ì • (ê°œë°œ/ì‹œì—°ìš©)
    â”œâ”€â”€ server-production.conf # Production ì„¤ì • (ì°¸ê³ ìš©)
    â””â”€â”€ security.conf        # ë³´ì•ˆ ì„¤ì •
```

---

**ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë° ë°ì´í„°ë² ì´ìŠ¤ ë¤í”„:**

```
exec/
â”œâ”€â”€ ì‹œìŠ¤í…œì•„í‚¤í…ì²˜.png                     # ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨
â”œâ”€â”€ dump-dollar_insight-postgreSQL.sql   # PostgreSQL ë°ì´í„°ë² ì´ìŠ¤ ë¤í”„
â”œâ”€â”€ mongodb_dump.zip                     # MongoDB ë°ì´í„°ë² ì´ìŠ¤ ë¤í”„
â””â”€â”€ í¬íŒ…ë§¤ë‰´ì–¼.md                         # ì´ ë¬¸ì„œ
```

---

#### ğŸ“‹ ì£¼ìš” ì„¤ì • íŒŒì¼ ìƒì„¸

**1. .env (ë£¨íŠ¸ ë””ë ‰í† ë¦¬)** - Docker Compose í™˜ê²½ ë³€ìˆ˜
```bash
# ìœ„ì¹˜: /opt/S13P31B205/.env
# ìš©ë„: Docker Compose ì»¨í…Œì´ë„ˆ í™˜ê²½ ë³€ìˆ˜

POSTGRES_USER=your-postgres-username
POSTGRES_PASSWORD=your-postgres-password
POSTGRES_DB=dollar_insight

MONGO_USER=your-mongo-username
MONGO_PASSWORD=your-mongo-password

REDIS_PASSWORD=your-redis-password

# Admin Tools
PGADMIN_EMAIL=your-email@example.com
PGADMIN_PASSWORD=your-pgadmin-password
```

**2. backend/.env** - Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ í™˜ê²½ ë³€ìˆ˜
```bash
# ìœ„ì¹˜: /opt/S13P31B205/backend/.env
# ìš©ë„: Spring Boot ì‹¤í–‰ ì‹œ í™˜ê²½ ë³€ìˆ˜

# PostgreSQL ì—°ê²° ì •ë³´
SPRING_DATASOURCE_URL=jdbc:postgresql://postgres:5432/dollar_insight
SPRING_DATASOURCE_USERNAME=your-postgres-username
SPRING_DATASOURCE_PASSWORD=your-postgres-password

# MongoDB ì—°ê²° ì •ë³´
SPRING_DATA_MONGODB_HOST=mongodb
SPRING_DATA_MONGODB_PORT=27017
SPRING_DATA_MONGODB_DATABASE=dollar_insight
SPRING_DATA_MONGODB_USERNAME=your-mongo-username
SPRING_DATA_MONGODB_PASSWORD=your-mongo-password

# Redis ì—°ê²° ì •ë³´
SPRING_REDIS_HOST=redis
SPRING_REDIS_PORT=6379
SPRING_REDIS_PASSWORD=your-redis-password

# JWT ì„¤ì •
APP_JWT_SECRET=your-jwt-secret-key-min-32-characters
```

**3. application.yml** - Spring Boot ë©”ì¸ ì„¤ì •
```yaml
# ìœ„ì¹˜: backend/src/main/resources/application.yml
# ìš©ë„: Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì • (.env í™˜ê²½ ë³€ìˆ˜ ì°¸ì¡°)

spring:
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:local}

  datasource:
    url: ${SPRING_DATASOURCE_URL}
    username: ${SPRING_DATASOURCE_USERNAME}
    password: ${SPRING_DATASOURCE_PASSWORD}
    driver-class-name: org.postgresql.Driver

  data:
    mongodb:
      host: ${SPRING_DATA_MONGODB_HOST}
      port: ${SPRING_DATA_MONGODB_PORT}
      database: ${SPRING_DATA_MONGODB_DATABASE}
      username: ${SPRING_DATA_MONGODB_USERNAME}
      password: ${SPRING_DATA_MONGODB_PASSWORD}

    redis:
      host: ${SPRING_REDIS_HOST}
      port: ${SPRING_REDIS_PORT}
      password: ${SPRING_REDIS_PASSWORD}

  jpa:
    hibernate:
      ddl-auto: ${SPRING_JPA_HIBERNATE_DDL_AUTO:validate}
    show-sql: ${SPRING_JPA_SHOW_SQL:false}

app:
  jwt:
    secret: ${APP_JWT_SECRET}
    access-ttl-seconds: ${APP_JWT-ACCESS_TTL_SECONDS:900}

logging:
  level:
    root: ${LOGGING_LEVEL_ROOT:INFO}
```

**4. docker-compose.yml** - Docker ì»¨í…Œì´ë„ˆ ì„¤ì •
```yaml
# ìœ„ì¹˜: /opt/S13P31B205/docker-compose.yml
# ìš©ë„: Docker ì„œë¹„ìŠ¤ ì •ì˜ (.env íŒŒì¼ ì°¸ì¡°)

services:
  postgres:
    environment:
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      POSTGRES_DB: ${POSTGRES_DB}
    ports:
      - "5432:5432" # ë‚´ë¶€ ì „ìš©

  mongodb:
    environment:
      MONGO_INITDB_ROOT_USERNAME: ${MONGO_USER}
      MONGO_INITDB_ROOT_PASSWORD: ${MONGO_PASSWORD}
    ports:
      - "27017:27017" # ë‚´ë¶€ ì „ìš©

  redis:
    command: redis-server --requirepass ${REDIS_PASSWORD}
    ports:
      - "6379:6379" # ë‚´ë¶€ ì „ìš©

  backend:
    env_file:
      - ./backend/.env
    ports:
      - "9090:9090"

  ai-service:
    env_file:
      - ./ai-service/.env
    ports:
      - "8000:8000"
```

---

#### ğŸ” ê³„ì • ì •ë³´ ìš”ì•½

| ì„œë¹„ìŠ¤ | ê³„ì • ì •ë³´ ìœ„ì¹˜ | ì ‘ì† ì •ë³´ |
|--------|--------------|---------|
| **PostgreSQL** | `.env` + `backend/.env` | Host: postgres (Docker ë‚´ë¶€)<br>Port: 5432<br>User: `.env`ì˜ `POSTGRES_USER`<br>Password: `.env`ì˜ `POSTGRES_PASSWORD`<br>Database: dollar_insight |
| **MongoDB** | `.env` + `backend/.env` + `ai-service/.env` | Host: mongodb (Docker ë‚´ë¶€)<br>Port: 27017<br>User: `.env`ì˜ `MONGO_USER`<br>Password: `.env`ì˜ `MONGO_PASSWORD`<br>Database: dollar_insight<br>Auth DB: admin |
| **Redis** | `.env` + `backend/.env` + `ai-service/.env` | Host: redis (Docker ë‚´ë¶€)<br>Port: 6379<br>Password: `.env`ì˜ `REDIS_PASSWORD` |
| **ChromaDB** | ë³„ë„ ì¸ì¦ ì—†ìŒ | Host: chromadb (Docker ë‚´ë¶€)<br>Port: 9000 |

---

#### ğŸ“Œ ì£¼ì˜ì‚¬í•­

1. **ì‹¤ì œ ê³„ì • ì •ë³´ëŠ” `.env` íŒŒì¼ì—ë§Œ ë³´ê´€**
   - `.env` íŒŒì¼ì€ Gitì— ì»¤ë°‹í•˜ì§€ ì•ŠìŒ (`.gitignore` í¬í•¨)
   - í…œí”Œë¦¿ íŒŒì¼(`.env.template`)ë§Œ Gitì— í¬í•¨

2. **í™˜ê²½ ë³€ìˆ˜ ìš°ì„ ìˆœìœ„**
   ```
   .env íŒŒì¼ â†’ application.yml â†’ ê¸°ë³¸ê°’
   ```

3. **Docker ë„¤íŠ¸ì›Œí¬ ë‚´ë¶€ í†µì‹ **
   - ì„œë¹„ìŠ¤ ê°„ í†µì‹ ì€ ì„œë¹„ìŠ¤ ì´ë¦„ ì‚¬ìš© (ì˜ˆ: `postgres`, `mongodb`)
   - ì™¸ë¶€ ì ‘ì†ì€ localhost ë˜ëŠ” ë„ë©”ì¸ ì‚¬ìš©

4. **ë³´ì•ˆ**
   - ëª¨ë“  ë¹„ë°€ë²ˆí˜¸ëŠ” ê°•ë ¥í•œ ê°’ ì‚¬ìš©
   - JWT Secretì€ `openssl rand -base64 32`ë¡œ ìƒì„±
   - ë°ì´í„°ë² ì´ìŠ¤ í¬íŠ¸ëŠ” ì™¸ë¶€ ë…¸ì¶œ ê¸ˆì§€

---

## 2. í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì™¸ë¶€ ì„œë¹„ìŠ¤ ì •ë³´

### 2.1 ì¸ì¦ ê´€ë ¨ ì™¸ë¶€ ì„œë¹„ìŠ¤

#### Google OAuth 2.0
- **ìš©ë„**: ì†Œì…œ ë¡œê·¸ì¸ (Google ê³„ì • ì—°ë™)
- **í•„ìš” ì •ë³´**:
  - Client ID: Google Cloud Consoleì—ì„œ ë°œê¸‰
  - Client Secret: Google Cloud Consoleì—ì„œ ë°œê¸‰
  - Redirect URI: `com.dollarinsight.app:/oauth2redirect/google`
- **ì„¤ì • ìœ„ì¹˜**: 
  - Backend: `application.yml`ì˜ `oauth.google` ì„¹ì…˜
  - Mobile: `.env`ì˜ `GOOGLE_CLIENT_ID`
- **ê°€ì… ë°©ë²•**: [Google Cloud Console](https://console.cloud.google.com/)

#### Kakao OAuth
- **ìš©ë„**: ì†Œì…œ ë¡œê·¸ì¸ (ì¹´ì¹´ì˜¤ ê³„ì • ì—°ë™)
- **í•„ìš” ì •ë³´**:
  - App Key: Kakao Developersì—ì„œ ë°œê¸‰
  - Client Secret: Kakao Developersì—ì„œ ë°œê¸‰
  - Redirect URI: `kakao{app_key}://oauth`
- **ì„¤ì • ìœ„ì¹˜**: 
  - Backend: `application.yml`ì˜ `oauth.kakao` ì„¹ì…˜
  - Mobile: `.env`ì˜ `KAKAO_CLIENT_ID`
- **ê°€ì… ë°©ë²•**: [Kakao Developers](https://developers.kakao.com/)

### 2.2 ë°ì´í„° ì œê³µ ì™¸ë¶€ ì„œë¹„ìŠ¤

#### ì£¼ì‹ ë°ì´í„° API
- **ìš©ë„**: ë¯¸êµ­ ì£¼ì‹ ì‹œì¥ ë°ì´í„° ìˆ˜ì§‘
- **ì œê³µì—…ì²´**: Alpha Vantage, Polygon.io, ë˜ëŠ” ìì²´ êµ¬ì¶•
- **í•„ìš” ì •ë³´**:
  - API Key
  - Rate Limit ì •ë³´
- **ì„¤ì • ìœ„ì¹˜**: `application.yml`ì˜ `external-api.stock` ì„¹ì…˜

#### ë‰´ìŠ¤ ë°ì´í„° API
- **ìš©ë„**: ì£¼ì‹ ê´€ë ¨ ë‰´ìŠ¤ ìˆ˜ì§‘
- **ì œê³µì—…ì²´**: Investing.com í¬ë¡¤ë§ ë˜ëŠ” News API
- **í•„ìš” ì •ë³´**:
  - API Key (í•´ë‹¹í•˜ëŠ” ê²½ìš°)
  - í¬ë¡¤ë§ ì£¼ê¸° ì„¤ì •
- **ì„¤ì • ìœ„ì¹˜**: `application.yml`ì˜ `external-api.news` ì„¹ì…˜

### 2.3 AI/ML ê´€ë ¨ ì™¸ë¶€ ì„œë¹„ìŠ¤

#### OpenAI API (ë˜ëŠ” ìì²´ ëª¨ë¸)
- **ìš©ë„**: AI í˜ë¥´ì†Œë‚˜ ì±„íŒ…, ìì—°ì–´ ì²˜ë¦¬
- **í•„ìš” ì •ë³´**:
  - API Key
  - Model ë²„ì „ ì •ë³´
- **ì„¤ì • ìœ„ì¹˜**: AI Serviceì˜ í™˜ê²½ ë³€ìˆ˜
- **ê°€ì… ë°©ë²•**: [OpenAI Platform](https://platform.openai.com/)

#### Vector Database (ChromaDB)
- **ìš©ë„**: ì„ë² ë”© ì €ì¥ ë° ìœ ì‚¬ë„ ê²€ìƒ‰
- **ì„¤ì •**: ìì²´ í˜¸ìŠ¤íŒ… (Docker ì»¨í…Œì´ë„ˆ)

### 2.4 í´ë¼ìš°ë“œ ì¸í”„ë¼ ì„œë¹„ìŠ¤

#### AWS EC2
- **ìš©ë„**: ì„œë²„ í˜¸ìŠ¤íŒ…
- **ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…**: t3.large ì´ìƒ ê¶Œì¥
- **ìŠ¤í† ë¦¬ì§€**: EBS 100GB ì´ìƒ
- **ë³´ì•ˆ ê·¸ë£¹**: 22(SSH), 80(HTTP), 443(HTTPS)

#### ë„ë©”ì¸ ë° SSL
- **ë„ë©”ì¸**: k13b205.p.ssafy.io (SSAFY ì œê³µ)
- **SSL ì¸ì¦ì„œ**: Let's Encrypt ìë™ ê°±ì‹ 

### 2.5 ëª¨ë‹ˆí„°ë§ ë° ë¡œê·¸ ê´€ë¦¬

#### Prometheus & Grafana
- **ìš©ë„**: ì‹œìŠ¤í…œ ëª¨ë‹ˆí„°ë§, ë©”íŠ¸ë¦­ ìˆ˜ì§‘
- **ì„¤ì •**: Docker Composeë¡œ ìë™ ë°°í¬
- **ì ‘ì†**: `https://k13b205.p.ssafy.io/grafana`

#### ë¡œê·¸ ê´€ë¦¬
- **Docker Logs**: ì»¨í…Œì´ë„ˆ ë¡œê·¸ ìˆ˜ì§‘
- **Application Logs**: Logbackì„ í†µí•œ êµ¬ì¡°í™”ëœ ë¡œê¹…

---

## ë¹Œë“œ ë° ë°°í¬ ëª…ë ¹ì–´

### ê°œë°œ í™˜ê²½ ì‹¤í–‰

**1ë‹¨ê³„: ì €ì¥ì†Œ í´ë¡ **
```bash
git clone https://lab.ssafy.com/s13-final/S13P31B205.git
cd S13P31B205
```

**2ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •** âš ï¸
```bash
# ëª¨ë“  í…œí”Œë¦¿ íŒŒì¼ ë³µì‚¬
cp .env.template .env
cp backend/.env.template backend/.env
cp ai-service/.env.template ai-service/.env
cp frontend/.env.template frontend/.env

# ê° .env íŒŒì¼ì„ ì—´ì–´ your-* í”Œë ˆì´ìŠ¤í™€ë”ë¥¼ ì‹¤ì œ ê°’ìœ¼ë¡œ êµì²´
# vim, nano, vscode ë“± ì‚¬ìš©

# í™˜ê²½ ë³€ìˆ˜ ê²€ì¦
chmod +x check-env.sh
./check-env.sh

# âœ… "All required .env files exist!" ë©”ì‹œì§€ í™•ì¸
```

> ğŸ’¡ **ìƒì„¸ ê°€ì´ë“œ**: [ENV_SETUP_GUIDE.md](../ENV_SETUP_GUIDE.md) ì°¸ì¡°

**3ë‹¨ê³„: Docker ì»¨í…Œì´ë„ˆ ì‹¤í–‰**
```bash
# ëª¨ë“  ì„œë¹„ìŠ¤ ë¹Œë“œ ë° ì‹¤í–‰
docker-compose up -d --build

# ë˜ëŠ” ë‹¨ê³„ë³„ ì‹¤í–‰
docker-compose up -d postgres mongodb redis chromadb  # DB ë¨¼ì €
docker-compose up -d backend ai-service                # ë°±ì—”ë“œ
docker-compose up -d nginx                             # Nginx
```

**4ë‹¨ê³„: ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸**
```bash
# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose ps

# ë¡œê·¸ í™•ì¸
docker-compose logs -f backend
docker-compose logs -f ai-service

# Health Check
curl http://localhost:9090/actuator/health  # Backend
curl http://localhost:8000/health           # AI Service
```

**5ë‹¨ê³„: Flutter ì•± ì‹¤í–‰**
```bash
cd frontend
flutter pub get
flutter run
```

**ì• í”Œë¦¬ì¼€ì´ì…˜ ì ‘ì†**
- Backend API: http://localhost:9090
- AI Service: http://localhost:8000
- Swagger UI: http://localhost:9090/swagger-ui/
- Frontend: Flutter ì•±ì„ í†µí•´ ì ‘ì†

### ìš´ì˜ í™˜ê²½ ë°°í¬

#### ğŸš€ deploy.sh ì‚¬ìš© ë°°í¬ (ê¶Œì¥)

í”„ë¡œì íŠ¸ëŠ” `deploy.sh` ìë™í™” ìŠ¤í¬ë¦½íŠ¸ë¥¼ í†µí•´ ë°°í¬í•©ë‹ˆë‹¤.

**ê¸°ë³¸ ë°°í¬**
```bash
# 1. ìš´ì˜ ì„œë²„ ì ‘ì†
ssh ubuntu@k13b205.p.ssafy.io

# 2. í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd /opt/S13P31B205

# 3. ìµœì‹  ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
git pull origin develop

# 4. ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ (ìë™: ë°±ì—… â†’ ì´ë¯¸ì§€ pull â†’ ì¬ì‹œì‘ â†’ health check)
./deploy.sh deploy
```

**Flutter APK ë¹Œë“œ ë° ë°°í¬**
```bash
# APK ë¹Œë“œ + ë°°í¬ (ìë™)
./deploy.sh build-and-deploy-apk

# ë˜ëŠ” ë‹¨ê³„ë³„ ì‹¤í–‰
./deploy.sh build-apk      # APKë§Œ ë¹Œë“œ
./deploy.sh deploy-apk     # ë¹Œë“œëœ APK ë°°í¬
```

**ì£¼ìš” ë°°í¬ ëª…ë ¹ì–´**
```bash
# ë°°í¬ ê´€ë ¨
./deploy.sh deploy              # ì•± ì„œë¹„ìŠ¤ ë°°í¬ (backend, ai-service, airflow)
./deploy.sh deploy-all          # ì „ì²´ ì„œë¹„ìŠ¤ ë°°í¬ (ìµœì´ˆ ë°°í¬ ì‹œ)
./deploy.sh rollback            # ì´ì „ ë²„ì „ìœ¼ë¡œ ë¡¤ë°±

# ì„œë¹„ìŠ¤ ì œì–´
./deploy.sh restart             # ì•± ì„œë¹„ìŠ¤ ì¬ì‹œì‘
./deploy.sh restart-all         # ì „ì²´ ì„œë¹„ìŠ¤ ì¬ì‹œì‘
./deploy.sh restart-service backend  # íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ì¬ì‹œì‘
./deploy.sh stop                # ì „ì²´ ì„œë¹„ìŠ¤ ì¤‘ì§€
./deploy.sh start               # ì „ì²´ ì„œë¹„ìŠ¤ ì‹œì‘

# ëª¨ë‹ˆí„°ë§
./deploy.sh status              # ì„œë¹„ìŠ¤ ìƒíƒœ ë° ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
./deploy.sh logs backend        # ë°±ì—”ë“œ ë¡œê·¸ í™•ì¸
./deploy.sh logs ai-service     # AI ì„œë¹„ìŠ¤ ë¡œê·¸ í™•ì¸
./deploy.sh health              # Health Check ì‹¤í–‰

# ìœ í‹¸ë¦¬í‹°
./deploy.sh cleanup             # Docker ë¦¬ì†ŒìŠ¤ ì •ë¦¬
```

**deploy.sh ìë™ ìˆ˜í–‰ ì‘ì—…**
1. âœ… í˜„ì¬ ë°°í¬ ë°±ì—… (ìµœëŒ€ 5ê°œ ìœ ì§€)
2. âœ… Docker Hubì—ì„œ ìµœì‹  ì´ë¯¸ì§€ Pull
3. âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ ì¬ì‹œì‘ (DB/NginxëŠ” ìœ ì§€)
4. âœ… Airflow ì„œë¹„ìŠ¤ ë°°í¬ (ìˆëŠ” ê²½ìš°)
5. âœ… Nginx DNS ìºì‹œ ê°±ì‹ 
6. âœ… Health Check ìë™ ì‹¤í–‰
7. âœ… ë°°í¬ ìƒíƒœ ë° ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ í‘œì‹œ

---

#### ğŸ“‹ ìˆ˜ë™ ë°°í¬ (ì°¸ê³ ìš©)

> **Note**: ì¼ë°˜ì ìœ¼ë¡œëŠ” `deploy.sh` ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤. ìˆ˜ë™ ë°°í¬ëŠ” íŠ¹ìˆ˜í•œ ìƒí™©ì—ì„œë§Œ ì‚¬ìš©í•˜ì„¸ìš”.

```bash
# í™˜ê²½ ë³€ìˆ˜ í™•ì¸ (ì²˜ìŒ ë°°í¬ ì‹œë§Œ)
./check-env.sh

# Docker ì´ë¯¸ì§€ Pull
docker compose pull backend ai-service

# ì„œë¹„ìŠ¤ ì¬ì‹œì‘
docker compose up -d --force-recreate --no-deps backend ai-service

# Health Check
curl https://k13b205.p.ssafy.io/actuator/health
curl https://k13b205.p.ssafy.io/ai/health

# SSL ì¸ì¦ì„œ ê°±ì‹  (í•„ìš”ì‹œ)
sudo certbot renew
```

---

#### âœ… ë°°í¬ ê²€ì¦

```bash
# ì„œë¹„ìŠ¤ ìƒíƒœ í™•ì¸
./deploy.sh status

# ë¡œê·¸ í™•ì¸
./deploy.sh logs backend
./deploy.sh logs ai-service

# Health Check
./deploy.sh health

# ë³´ì•ˆ ê²€ì¦ (ì„ íƒì‚¬í•­)
./test-security.sh https://k13b205.p.ssafy.io

# APK ë‹¤ìš´ë¡œë“œ í™•ì¸
curl -I https://k13b205.p.ssafy.io/apk/app-release.apk
# ì‘ë‹µ: HTTP/2 200 OK
```

### ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
```bash
# PostgreSQL ìŠ¤í‚¤ë§ˆ ì ìš©
docker exec -it dollarinsight-postgres-1 psql -U postgres -d dollarinsight -f /docker-entrypoint-initdb.d/schema.sql

# MongoDB ì´ˆê¸°í™”
docker exec -it dollarinsight-mongodb-1 mongo -u admin -p password dollarinsight_mongo /docker-entrypoint-initdb.d/init.js
```

---

## ì£¼ì˜ì‚¬í•­

### í•„ìˆ˜ ì£¼ì˜ì‚¬í•­

1. **í™˜ê²½ ë³€ìˆ˜ ë³´ì•ˆ** âš ï¸ ë§¤ìš° ì¤‘ìš”!
   - âœ… `.env.template` íŒŒì¼ë§Œ Gitì— ì»¤ë°‹ (í”Œë ˆì´ìŠ¤í™€ë” ê°’ë§Œ)
   - âœ… ì‹¤ì œ `.env` íŒŒì¼ì€ ë¡œì»¬/ì„œë²„ì—ë§Œ ë³´ê´€ (`.gitignore` í™•ì¸)
   - âœ… JWT Secretì€ ë°˜ë“œì‹œ ê°•ë ¥í•œ ëœë¤ ê°’ ì‚¬ìš©: `openssl rand -base64 32`
   - âŒ API Key, ë¹„ë°€ë²ˆí˜¸ë¥¼ ì½”ë“œì— í•˜ë“œì½”ë”© ì ˆëŒ€ ê¸ˆì§€
   - âŒ `.env` íŒŒì¼ì„ Gitì— ì»¤ë°‹í•˜ë©´ ì•ˆ ë¨!

2. **ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—…**
   - ì •ê¸°ì ì¸ ë°ì´í„° ë°±ì—… ìŠ¤ì¼€ì¤„ ì„¤ì •
   - `./deploy.sh`ëŠ” ìë™ ë°±ì—… ìˆ˜í–‰ (ìµœëŒ€ 5ê°œ ìœ ì§€)

3. **ë¡œê·¸ ëª¨ë‹ˆí„°ë§**
   - Grafana ëŒ€ì‹œë³´ë“œë¥¼ í†µí•œ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
   - `./deploy.sh logs [service]`ë¡œ ë¡œê·¸ í™•ì¸

4. **SSL ì¸ì¦ì„œ**
   - Let's Encrypt ìë™ ê°±ì‹  ì„¤ì • í™•ì¸
   - `sudo certbot renew --dry-run`ìœ¼ë¡œ í…ŒìŠ¤íŠ¸

5. **ë°©í™”ë²½ ì„¤ì •**
   - SSH(22), HTTP(80), HTTPS(443)ë§Œ ì˜¤í”ˆ
   - ë°ì´í„°ë² ì´ìŠ¤ í¬íŠ¸ëŠ” ì™¸ë¶€ ë…¸ì¶œ ê¸ˆì§€

### ë³´ì•ˆ ì°¸ê³  ë¬¸ì„œ (ì„ íƒì‚¬í•­)

> **Note**: SSAFY í”„ë¡œì íŠ¸ëŠ” êµìœ¡/ì‹œì—° ëª©ì ì´ë¯€ë¡œ ì•„ë˜ ë¬¸ì„œë“¤ì€ **ì°¸ê³ ìš©**ì…ë‹ˆë‹¤.
> ì‹¤ì œ ìƒìš© ì„œë¹„ìŠ¤ ìš´ì˜ ì‹œ ì ìš©í•  ìˆ˜ ìˆëŠ” ëª¨ë²” ì‚¬ë¡€ë¥¼ ë‹´ê³  ìˆìŠµë‹ˆë‹¤.


**í˜„ì¬ í”„ë¡œì íŠ¸ ì„¤ì •**:
- Swagger UI, Admin Tools ì ‘ê·¼ ê°€ëŠ¥ (ê°œë°œ/ì‹œì—° í¸ì˜)
- ê¸°ë³¸ ë³´ì•ˆ (HTTPS, JWT, Rate Limiting) ì ìš©ë¨
- ì°¸ê³  ë¬¸ì„œëŠ” ìƒìš© ì„œë¹„ìŠ¤ ì „í™˜ ì‹œ í™œìš©

---

**ë¬¸ì„œ ì‘ì„±ì¼**: 2024ë…„ 11ì›” 19ì¼
**í”„ë¡œì íŠ¸**: Dollar In$ight (S13P31B205)
**ì‘ì„±ì**: SSAFY 13ê¸° ììœ¨ í”„ë¡œì íŠ¸ B205íŒ€
